{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OpenMedMedication",
  "description": "Schema for OpenMed medication data format",
  "type": "object",
  "required": [
    "catalogId",
    "name",
    "status",
    "category",
    "registrationValidity",
    "registrationNumber",
    "treatmentDescriptions",
    "termsOfIssue",
    "form",
    "route",
    "site",
    "method",
    "administrationNotes",
    "ingredients",
    "codes",
    "contraindications",
    "sideEffect",
    "warnings",
    "alternativeMedications",
    "packaging",
    "metadata"
  ],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["version", "lastUpdated"],
      "properties": {
        "version": {
          "type": "string",
          "const": "1.4",
          "description": "Schema version"
        },
        "lastUpdated": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of last update"
        }
      },
      "additionalProperties": false
    },
    "catalogId": {
      "type": "string",
      "description": "Unique catalog identifier (UUID)",
      "format": "uuid"
    },
    "name": {
      "type": "string",
      "description": "Product name",
      "maxLength": 500
    },
    "status": {
      "type": "string",
      "description": "Current status of the medication",
      "enum": [
        "draft",
        "active",
        "inactive",
        "discontinued",
        "pending",
        "approved",
        "rejected",
        "expired",
        "withdrawn"
      ]
    },
    "category": {
      "type": "string",
      "description": "Medication category",
      "enum": ["prescription", "off-the-counter", "29C"]
    },
    "registrationValidity": {
      "type": "string",
      "description": "Registration validity status",
      "enum": [
        "valid",
        "expired",
        "pending",
        "suspended",
        "revoked",
        "not-registered"
      ]
    },
    "registrationNumber": {
      "type": "string",
      "description": "Registration number for the medication",
      "maxLength": 100
    },
    "treatmentDescriptions": {
      "type": "string",
      "description": "Description of treatment indications",
      "maxLength": 2000
    },
    "termsOfIssue": {
      "type": "string",
      "description": "Terms and conditions for medication issue",
      "maxLength": 1000
    },
    "form": {
      "type": "string",
      "description": "Pharmaceutical form",
      "enum": [
        "tablet",
        "capsule",
        "liquid",
        "injection",
        "cream",
        "ointment",
        "gel",
        "suppository",
        "inhaler",
        "drops",
        "spray",
        "patch",
        "powder",
        "suspension",
        "emulsion",
        "solution",
        "granules",
        "lozenge",
        "inhalation-powder",
        "inhalation-suspension"
      ]
    },
    "route": {
      "type": "string",
      "description": "Administration route",
      "enum": [
        "oral",
        "intravenous",
        "intramuscular",
        "subcutaneous",
        "topical",
        "inhalation",
        "rectal",
        "vaginal",
        "ophthalmic",
        "otic",
        "nasal",
        "transdermal",
        "buccal",
        "sublingual",
        "intradermal",
        "intrathecal",
        "epidural",
        "intra-articular",
        "intraperitoneal",
        "intravitreal"
      ]
    },
    "site": {
      "type": "string",
      "description": "Administration site",
      "maxLength": 200
    },
    "method": {
      "type": "string",
      "description": "Administration method",
      "maxLength": 200
    },
    "administrationNotes": {
      "type": "string",
      "description": "Notes for administration",
      "maxLength": 1000
    },
    "ingredients": {
      "type": "string",
      "description": "Medication ingredients information",
      "maxLength": 500
    },
    "codes": {
      "type": "object",
      "properties": {
        "atc5": {
          "type": "object",
          "properties": {
            "system": {
              "type": "string",
              "description": "ATC classification system identifier"
            },
            "code": {
              "type": "string",
              "description": "ATC5 classification code"
            },
            "name": {
              "type": "string",
              "description": "ATC5 classification name"
            }
          },
          "additionalProperties": false
        },
        "snomedCTIntegrationComposition": {
          "type": "object",
          "properties": {
            "system": {
              "type": "string",
              "description": "SNOMED CT system identifier"
            },
            "code": {
              "type": "string",
              "description": "SNOMED CT integration composition code"
            },
            "name": {
              "type": "string",
              "description": "SNOMED CT integration composition name"
            }
          },
          "additionalProperties": false
        },
        "snomedCTClinicalDrug": {
          "type": "object",
          "properties": {
            "system": {
              "type": "string",
              "description": "SNOMED CT system identifier"
            },
            "code": {
              "type": "string",
              "description": "SNOMED CT clinical drug code"
            },
            "name": {
              "type": "string",
              "description": "SNOMED CT clinical drug name"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "contraindications": {
      "type": "string",
      "description": "Contraindications for use",
      "maxLength": 2000
    },
    "sideEffect": {
      "type": "string",
      "description": "Side effects information",
      "maxLength": 2000
    },
    "warnings": {
      "type": "string",
      "description": "Warnings and precautions",
      "maxLength": 2000
    },
    "alternativeMedications": {
      "type": "array",
      "description": "Alternative medication catalog IDs",
      "items": {
        "type": "string",
        "format": "uuid"
      }
    },
    "packaging": {
      "type": "array",
      "description": "Available packaging options",
      "items": {
        "type": "object",
        "required": [
          "name",
          "manufacturer",
          "strength",
          "quantity",
          "packagingDescription",
          "shelfLife",
          "storageConditions",
          "codes",
          "manufacturersAdministrationRecommendation",
          "pricing"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Package name",
            "maxLength": 200
          },
          "manufacturer": {
            "type": "object",
            "required": ["name", "countryOfOrigin"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Manufacturer name",
                "maxLength": 200
              },
              "countryOfOrigin": {
                "type": "string",
                "description": "Country of origin",
                "pattern": "^[A-Z]{2}$"
              }
            },
            "additionalProperties": false
          },
          "strength": {
            "type": "object",
            "required": ["value", "unit"],
            "properties": {
              "value": {
                "type": "number",
                "description": "Strength value"
              },
              "unit": {
                "type": "string",
                "description": "Strength unit"
              }
            },
            "additionalProperties": false
          },
          "quantity": {
            "type": "object",
            "required": ["value", "unit"],
            "properties": {
              "value": {
                "type": "number",
                "description": "Quantity value"
              },
              "unit": {
                "type": "string",
                "description": "Quantity unit"
              }
            },
            "additionalProperties": false
          },
          "packagingDescription": {
            "type": "string",
            "description": "Description of the packaging",
            "maxLength": 500
          },
          "shelfLife": {
            "type": "string",
            "description": "Shelf life information",
            "maxLength": 200
          },
          "storageConditions": {
            "type": "string",
            "description": "Storage conditions information",
            "maxLength": 500
          },
          "codes": {
            "type": "object",
            "properties": {
              "barcode": {
                "type": "string",
                "description": "Barcode identifier",
                "maxLength": 50
              },
              "pharmasoft": {
                "type": "string",
                "description": "PharmaSoft database code",
                "maxLength": 50
              },
              "superpharm": {
                "type": "string",
                "description": "SuperPharm code",
                "maxLength": 50
              },
              "yarpa": {
                "type": "string",
                "description": "Yarpa code",
                "maxLength": 50
              },
              "moh": {
                "type": "string",
                "description": "Ministry of Health registration number",
                "maxLength": 50
              }
            },
            "additionalProperties": true
          },
          "manufacturersAdministrationRecommendation": {
            "type": "string",
            "description": "Manufacturer's administration recommendations",
            "maxLength": 1000
          },
          "pricing": {
            "type": "object",
            "properties": {
              "maxWholesalePrice": {
                "type": "number",
                "description": "Maximum wholesale price"
              },
              "retailMargin": {
                "type": "number",
                "description": "Retail margin percentage"
              },
              "maxRetailPrice": {
                "type": "number",
                "description": "Maximum retail price"
              },
              "maxPriceWithVAT": {
                "type": "number",
                "description": "Maximum price including VAT"
              },
              "currency": {
                "type": "string",
                "description": "Currency code",
                "pattern": "^[A-Z]{3}$"
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
